<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - Posts tagged "Haskell"</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            
<h4><a href="../posts/2017-01-27-how-i-learned-haskell.html">How I learned Haskell</a></h4> - January 27, 2017
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - How I learned Haskell</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>How I learned Haskell</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on January 27, 2017
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/Haskell.html">Haskell</a>
      
  </div>

<p>Happy lunar new year! Today I would like to share my experience of learning Haskell. It’s been a really long journey but a really wonderful one.</p>
<!--more-->
<h1 id="first-encounter">First Encounter</h1>
<p>Back in 2000, I was an undergraduate student majoring in computer science. At that time, I was into system programming and enjoyed learning low-level implementation details of operating systems and system applications. My primary language was C and programmed all programming assignments in C. I was proud that I understood how my code was compiled and executed on the machine.</p>
<p>One day my friend told me about <em>Haskell</em>. I wasn’t interested in functional programming at that time, but I became curious because he enthusiastically persuaded me to learn Haskell. I ended up reading two books on Haskell.</p>
<ul>
<li><a href="http://www.haskellcraft.com/craft3e/Home.html">Haskell: the Craft of Functional Programming</a></li>
<li><a href="http://www.cs.yale.edu/homes/hudak/SOE/">The Haskell School of Expression</a></li>
</ul>
<p>Both books were really nice and I learned I could program in an entirely different way. However, I wasn’t sure if Haskell could solve the real-world problems I wanted to solve. So my interest in Haskell stopped there.</p>
<h1 id="dark-age">Dark age</h1>
<p>My first job was mainly about porting and optimizing Java Virtual Machine for embedded systems. My company licensed Sun’s CDC JVM and I was responsible for maintaining it.</p>
<p>It was 2002 and Linux was still a luxury for embedded systems. RTOSes such as pSOS and VxWorks were popular on STBs and I ported JVM to these OSes. These RTOSes didn’t have distinctions between kernel and user space and an application was linked statically with the kernel and ran as a single (kernel) process application on the device.</p>
<p>The implication was profound. I had no safety guarantee provided by modern operating systems. A bug in an application could corrupt the kernel data and crash the entire system. Moreover, because there were dozens of threads competing for shared resources, race conditions and dead locks were a common place. It took hours or even days to find and fix a trivial bug.</p>
<p>The situation was much better when debugging an application written in Java. Thanks to the safety guarantee of Java, certain types of bugs were impossible. A Java program can’t corrupt memory and crash the system. Dead locks are reported systematically by the JVM. It was relatively fun to fix a bug in Java applications.</p>
<p>These experiences gave me the motivation to find systematic ways of preventing bugs and led me to read Benjamin C. Pierce’s <a href="https://www.cis.upenn.edu/~bcpierce/tapl/">Types and Programming Languages</a>. It was the best computer science text book I’ve ever read. I understood why types were important in statically typed functional languages like Haskell! If universities had used this book as a undergraduate PL textbook, many of the confusions and misunderstandings about dynamic vs static typing would have disappeared.</p>
<h1 id="stuck-again">Stuck again</h1>
<p>By fully understanding the merits of type systems, I started to learn Haskell in a different perspective. I read <a href="https://www.haskell.org/tutorial/index.html">A Gentle Introduction To Haskell</a> and many tutorials on monads. It wasn’t very hard to understand specific instances of monads such as <em>Reader</em>, <em>Writer</em>, <em>State</em>, <em>List</em> and <em>Maybe</em>. But I couldn’t figure out how they were related. I managed to write simple applications in Haskell, but wasn’t confident that I could use Haskell productively because I couldn’t fully understand one of the core ideas of Haskell.</p>
<h1 id="the-challenges-of-multi-core-programming">The Challenges of Multi-core Programming</h1>
<p>In the meantime, I changed my career and founded a tech start-up in 2008. I built mobile web browsers for the embedded systems. I created a port of <a href="https://webkit.org/">WebKit</a> and hacked various components of WebKit to speed up the performance. The primary means for optimization was to leverage the multi-core CPU and GPU.</p>
<p>WebKit performs lots of tasks concurrently but it is mostly single-threaded. Loading a page does not benefit much from having a multi-core CPU. So I offloaded some tasks to separate threads but I only gained marginal performance benefits in exchange for largely increased complexity. I learned a lesson that I must pay very high costs of complexity to get small benefits of performance boost. Considering the already complex nature of WebKit, I ended up abandoning most of performance optimizations to keep the complexity under control.</p>
<p>While struggling to squeeze performance out of WebKit, I learned Haskell again to get some insights on parallel programming because Haskell was the only programming language which natively supported <em>STM(Software Transaction Memory)</em>. Simon Marlow’s <a href="http://chimera.labs.oreilly.com/books/1230000000929/index.html">Parallel and Concurrent Programming in Haskell</a> helped me understand how Haskell supported parallel and concurrent programming. Though I learned many valuable lessons from the book, I also felt that the lazy nature of Haskell didn’t go well with parallel programming.</p>
<h1 id="reunion">Reunion</h1>
<p>I have spent more than 10 years of my career on embedded systems and increasingly got frustrated with the tools available. So I decided to teach myself Haskell again and use it at work. This time I started to read classic papers on functional programming and Haskell.</p>
<p>Philip Wadler’s <a href="http://homepages.inf.ed.ac.uk/wadler/papers/marktoberdorf/baastad.pdf">Monads for functional programming</a> clicked my mind and I finally became enlightened. The paper is really well written, but I don’t think I could understand <em>Monad</em> just because I read the paper. Years of trials and errors were necessary to understand an abstract concepts like monad. It was the most exciting moment of my long journey to Haskell.</p>
<p>Once I understood how I could learn abstractions, the rest was easy. Now I don’t get discouraged just because I don’t understand abstractions at first glance. It takes time and practice to understand abstract things. I also realized that monad was just the beginning. There exist many Haskell idioms that require other abstract concepts such as <em>applicative functor</em>, <em>arrow</em>, <em>profunctor</em> and so on.</p>
<p>Here is the list of papers I found most enlightening when learning Haskell. I also recommend you read any paper with “Functional Pearl” attached to it.</p>
<ul>
<li><a href="http://www.cs.nott.ac.uk/~pszgmh/fold.pdf">A tutorial on the universality and expressiveness of fold</a></li>
<li><a href="http://www.cs.nott.ac.uk/~pszgmh/pearl.pdf">Monadic Parsing in Haskell</a></li>
<li><a href="http://haskell.cs.yale.edu/wp-content/uploads/2011/02/POPL96-Modular-interpreters.pdf">Monad Transformers and Modular Interpreters</a></li>
<li><a href="http://www.cs.ru.nl/~W.Swierstra/Publications/DataTypesALaCarte.pdf">Data types a la carte</a></li>
<li><a href="https://www.cs.ox.ac.uk/jeremy.gibbons/publications/iterator.pdf">The Essence of the Iterator Pattern</a></li>
<li><a href="https://www.st.cs.uni-saarland.de/edu/seminare/2005/advanced-fp/docs/huet-zipper.pdf">The Zipper</a></li>
</ul>
<h1 id="back-to-real-world">Back to Real-World</h1>
<p>I was confident that Haskell was a good programming language and I was looking for opportunities to use Haskell in production. Bryan O’Sullivan, Don Stewart, and John Goerzen’s <a href="http://book.realworldhaskell.org/">Real World Haskell</a> was a good reference in this direction. It showed how I could use Haskell to do my daily work such as networking, system programming, databases and web programming.</p>
<p>Finally, I started to read real-world Haskell code available on the hackage and realized that the <em>Haskell I know</em> was different from the <em>Haskell that is actually used</em>. Real world Haskell uses lots of GHC extensions which makes me feel it is an entirely different language. A typical Haskell module starts with:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">{-# LANGUAGE CPP                        #-}</span>
<span class="ot">{-# LANGUAGE FlexibleContexts           #-}</span>
<span class="ot">{-# LANGUAGE ConstraintKinds            #-}</span>
<span class="ot">{-# LANGUAGE FlexibleInstances          #-}</span>
<span class="ot">{-# LANGUAGE FunctionalDependencies     #-}</span>
<span class="ot">{-# LANGUAGE OverloadedStrings          #-}</span>
<span class="ot">{-# LANGUAGE QuasiQuotes                #-}</span>
<span class="ot">{-# LANGUAGE RecordWildCards            #-}</span>
<span class="ot">{-# LANGUAGE TupleSections              #-}</span>
<span class="ot">{-# LANGUAGE TypeFamilies               #-}</span>
<span class="ot">{-# LANGUAGE RankNTypes                 #-}</span>
<span class="ot">{-# LANGUAGE DeriveDataTypeable         #-}</span></code></pre></div>
<p>It seems sticking to Haskell 98 or 2000 does not have much practical sense because many Haskell packages already use many GHC extensions. So I learned them too. <a href="https://ocharles.org.uk/blog/posts/2014-12-01-24-days-of-ghc-extensions.html">24 Days of GHC Extensions</a> was a really great way of learning this topic.</p>
<p>I like the approach of <a href="http://www.yesodweb.com/book/haskell">Yesod Web Framework Book</a> which explains the GHC extensions used in the library before explaining how to use the library. This is often the first step to learn a new library for many Haskell programmers. For example, you can’t use <a href="http://haskell-servant.readthedocs.io/en/stable/">Servant</a> unless you understand <em>DataKinds</em> and <em>TypeOperators</em>. So I encourage Haskell library authors to write more about the GHC extensions they use.</p>
<p>I also found that some packages are essential to use Haskell in practice.</p>
<ul>
<li><code>String</code> type has problems. You need either <a href="https://hackage.haskell.org/package/text">text</a> or <a href="https://hackage.haskell.org/package/bytestring">bytestring</a> for efficient string data processing.</li>
<li>Lazy IO looks nice, but does not work well in practice. To process streaming data properly you need either <a href="https://hackage.haskell.org/package/pipes-4.3.2/docs/Pipes-Tutorial.html">pipes</a> or <a href="https://github.com/snoyberg/conduit#readme">conduit</a>.</li>
<li>You will need a custom monad or monad transformer for your application sooner or later. Either <a href="https://hackage.haskell.org/package/mtl">mtl</a> or <a href="https://hackage.haskell.org/package/transformers">transformers</a> is required.</li>
<li>JSON is a really universal data exchange format these days. <a href="https://hackage.haskell.org/package/aeson-1.1.0.0/docs/Data-Aeson.html">aeson</a> will help you here.</li>
<li><a href="https://hackage.haskell.org/package/QuickCheck">QuickCheck</a> is a bonus you get from using Haskell!</li>
</ul>
<h1 id="haskell-in-production">Haskell in production</h1>
<p>I founded a small Haskell shop this year and started to use Haskell in production. I realized that using Haskell in production was, surprisingly, easier than learning Haskell. It took me more than 10 years to learn Haskell, but I felt confident that I could use Haskell in production only after a few months of experiments.</p>
<p>There is one thing I would like to emphasize. Using Haskell does not mean that you must understand all the dependencies you use. Haskell programmers tend to care much about the implementation details of their dependencies because Haskell makes it so easy to understand the meaning of programs with types and equational reasoning. But in my opinion, this is a blessed curse.</p>
<p>That’s not how civilization works. You can drive a car without understanding how engines work. Python or JavaScript programmers do not care about the implementation details of their dependencies because it is simply impossible. Haskell is no exception. Time and money are limited. Please don’t spend too much time on understanding things. Spend more time on building things. Be practical.</p>
<p>Fortunately, some library authors provide a high-level overview of their library. <a href="https://www.andres-loeh.de/Servant/servant-wgp.pdf">Type-level Web APIs with Servant</a> is a great example. It explains the core concepts and the implementation techniques of the library without involving accidental complexities of implementation details. I would love to see more papers like this.</p>
<h1 id="tools-and-libraries">Tools and Libraries</h1>
<p><a href="https://www.stackage.org/">Stackage</a> and the <a href="https://docs.haskellstack.org/en/stable/README/">Stack</a> are indispensable tools to use Haskell in production. All the hard work of <a href="https://www.fpcomplete.com/">FP Complete</a> gave me confidence that Haskell was production-ready. The Haskell ecosystem is not small anymore. There are multiple competing web frameworks such as <a href="http://www.yesodweb.com/">Yesod</a>, <a href="https://hackage.haskell.org/package/scotty">Scotty</a>, <a href="http://snapframework.com/">Snap</a>, <a href="http://www.happstack.com/page/view-page-slug/1/happstack">Happstack</a> and <a href="http://haskell-servant.readthedocs.io/en/stable/">Servant</a>. Qualities of these packages are all good.</p>
<p>If you write web servers in Haskell, all the packages you need such as web servers, web frameworks, logging packages, database drivers are already available. I use <em>Servant</em>, <a href="https://hackage.haskell.org/package/persistent">persistent</a> and <a href="https://hackage.haskell.org/package/esqueleto">esqueleto</a> for my server. So far, everything works fine.</p>
<h1 id="haskell-community">Haskell Community</h1>
<p>Haskell community is relatively small compared to other major languages, but I am often surprised by the quality of feedback I get from the community. Haskell is a great language, but the community is even greater. That’s the biggest reason why I love programming in Haskell.</p>
<p>My journey to Haskell is still going on.</p>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2017-01-27-how-i-learned-haskell.html";
    this.page.identifier = "/posts/2017-01-27-how-i-learned-haskell.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2017-01-27-how-i-learned-haskell.html">Read more</a>

<h4><a href="../posts/2016-12-31-type-inference-algorithms-of-haskell-like-languages.html">Type inference algorithms of Haskell-like languages</a></h4> - December 31, 2016
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - Type inference algorithms of Haskell-like languages</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Type inference algorithms of Haskell-like languages</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on December 31, 2016
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/type%20inference.html">type inference</a>, <a href="../tags/type%20system.html">type system</a>, <a href="../tags/Haskell.html">Haskell</a>
      
  </div>

<p>I collected papers on the type inference algorithms used by Haskell-like languages.</p>
<h1 id="haskell">Haskell</h1>
<p>Haskell supports advanced type system features such as GADTs, type classes and type families. The current type checker implemented by GHC is described in <a href="https://www.microsoft.com/en-us/research/publication/outsideinx-modular-type-inference-with-local-assumptions/">OutsideIn(X): Modular type inference with local assumptions</a>.</p>
<h1 id="purescript">PureScript</h1>
<p>The type checker of PureScript is inspired by the following papers. It supports type classes, row polymorphism, higher kinded polymorphism (rank N types). There are no soundness proofs yet.</p>
<ul>
<li><a href="https://people.mpi-sws.org/~neelk/bidir.pdf">Complete and Easy Bidirectional Typechecking for Higher-Rank Polymorphism</a></li>
<li><a href="https://www.microsoft.com/en-us/research/publication/hmf-simple-type-inference-for-first-class-polymorphism/">HMF: Simple Type Inference for First-Class Polymorphism</a></li>
<li><a href="https://www.microsoft.com/en-us/research/publication/koka-programming-with-row-polymorphic-effect-types/">Koka: Programming with Row-polymorphic Effect Types</a></li>
</ul>
<h1 id="elm">Elm</h1>
<p>Elm’s type checker is an implementation of Pottier and Rem’s <a href="http://gallium.inria.fr/~fpottier/publis/emlti-final.pdf">The Essence of ML Type Inference</a> with two extensions:</p>
<ul>
<li>A limited set of built-in type classes (i.e. number, appendable, comparable)</li>
<li>Records based on <a href="https://www.microsoft.com/en-us/research/publication/extensible-records-with-scoped-labels/">Extensible records with scoped labels</a></li>
</ul>
<p>There is no support for type classes or higher kinded polymorphism yet.</p>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2016-12-31-type-inference-algorithms-of-haskell-like-languages.html";
    this.page.identifier = "/posts/2016-12-31-type-inference-algorithms-of-haskell-like-languages.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2016-12-31-type-inference-algorithms-of-haskell-like-languages.html">Read more</a>

<h4><a href="../posts/2016-06-01-learn-haskell-to-be-a-better-programmer.html">Learn Haskell to be a better programmer</a></h4> - June  1, 2016
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - Learn Haskell to be a better programmer</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Learn Haskell to be a better programmer</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on June  1, 2016
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/Haskell.html">Haskell</a>, <a href="../tags/category%20theory.html">category theory</a>, <a href="../tags/composition.html">composition</a>
      
  </div>

<p>Haskell is notorious for being hard to learn. Pure functions, lazy evaluation, Haskell type system are just start.</p>
<p>To use Haskell effectively, it is necessary to learn the abstract concepts borrowed from the category theory such as Functor, Applicative Functor and Monad. You need to understand these concepts throughly because most of Haskell code is written using these abstract non-sense.</p>
<p>Of course, it is still possible to write IO code and use <code>Maybe</code>, <code>Either</code> and <code>List</code> types without understanding Monad. But then why do you want to learn Haskell anyway? If you avoid learning these concpets, you can’t learn much from Haskell. It would be much beneficial to learn other more practical languages.</p>
<p>Before explaining why you should learn Haskell, let’s ask a question. What’s the essence of programming?</p>
<p>Programming is basically instructing the computer to some labor. For example, “Load the value at memory x into the register, add 1 to it, and store the value back to the memory” is a program.</p>
<p>But a program is not just a sequence of instructions. It is a solution to our real problem. What makes programming interesting is that the problems we solve as a programmer is much bigger in size than simply loading a value from the memory and doing some arithmetic.</p>
<p>So programming is to divide a big problem that can’t be solved at once into many small problems, solve them independently, and compose the resulting small programs into a program that solves the original problem. In other words, the essence of programming is recomposition after decomposition. See Bartosz Milewski’s <a href="https://bartoszmilewski.com/2014/11/04/category-the-essence-of-composition/">Category: The Essence of Composition</a>.</p>
<p>Here comes the most important property of programming, which is called <em>composability</em>. We need to solve many complex problems which are similar but not exactly same. If we can compose small reusable programs into a new program which solves the new problem, the productivity of a programmer will be dramatically increased.</p>
<p>The changes of programming paradigm in the history can be explained as our continous endeavor to enhance the composability. For example, the shift from assembly programming with goto to structure programming emphasizing subroutine and loop was necessary as the problem size increases. We desparately needed a better way to compose programs.</p>
<p>But as the complexity of problem drastically increased again in 80-90s, we needed a new programming paradigm called object-oriented programming. Classes and objects, encapsulation and information hiding were another endeavor to imporve the composability of programs.</p>
<p>Now in 2010s, functional programming is gaining attention. The complexity of problems we have today is enormous and we need new tools and concepts to cope with ever increasing complexity. Classes are not enough. We need more composability.</p>
<p>Haskell provides new tools and concepts which can help organize code better. Concepts like Functor, Applicative Functor, Monad, Arrow and Lense all provide new means to compose programs. See Gabriel Gonzalez’s <a href="http://www.haskellforall.com/2012/08/the-category-design-pattern.html">The category design pattern</a>.</p>
<p>In fact, you already know some of these concepts. For example, ES6’s Promise, C#’s null propagation operator, Python’s list comprehension all share the same monadic structure. But you probably never noticed the common structure lying behind these different language features. After you learn Haskell, you will begin to see the common structure you’ve never imagined before.</p>
<p>In summary, the essence of programming is <em>composition</em>. Haskell provides new tools and concepts to compose programs. Learning Haskell improves your code organizational skills and make you prepared to handle more complex problems. <a href="http://learnyouahaskell.com/chapters">Learn you a Haskell for great good!</a></p>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2016-06-01-learn-haskell-to-be-a-better-programmer.html";
    this.page.identifier = "/posts/2016-06-01-learn-haskell-to-be-a-better-programmer.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2016-06-01-learn-haskell-to-be-a-better-programmer.html">Read more</a>

<h4><a href="../posts/2014-03-02-evaluation-strategy-haskell-vs-scala.html">Evaluation Strategy: Haskell vs Scala</a></h4> - March  2, 2014
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - Evaluation Strategy: Haskell vs Scala</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Evaluation Strategy: Haskell vs Scala</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on March  2, 2014
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/Haskell.html">Haskell</a>, <a href="../tags/Scala.html">Scala</a>, <a href="../tags/evaluation%20strategy.html">evaluation strategy</a>
      
  </div>

<p>Haskell is a non-strict language, and GHC uses a strategy called laziness which combines non-strictness and sharing for efficiency.</p>
<p>Thus, you can easily implement <a href="http://hackage.haskell.org/package/base-4.6.0.1/docs/Prelude.html#v:const">const</a> which never uses the second argument.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">const x y <span class="fu">=</span> x</code></pre></div>
<p>With this definition, it is okay to pass <code>undefined</code> as the second argument of <code>const</code> because <code>y</code> is not never evaluated. But in Haskell, you can also make an argument strict using the <a href="https://ocharles.org.uk/blog/posts/2014-12-05-bang-patterns.html">BangPatterns GHC extension</a>.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">const x <span class="fu">!</span>y <span class="fu">=</span> x</code></pre></div>
<p>Interestingly, the situation is reversed in Scala whose default evaluation strategy is strict.</p>
<div class="sourceCode"><pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">def</span> <span class="fu">const</span>(x: Int, y:Int) = x</code></pre></div>
<p>You can make an argument non-strict by putting the <code>=&gt;</code> symbol between the variable name and the type.</p>
<div class="sourceCode"><pre class="sourceCode scala"><code class="sourceCode scala"><span class="kw">def</span> <span class="fu">const</span>(x: Int, y: =&gt; Int) = x</code></pre></div>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2014-03-02-evaluation-strategy-haskell-vs-scala.html";
    this.page.identifier = "/posts/2014-03-02-evaluation-strategy-haskell-vs-scala.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2014-03-02-evaluation-strategy-haskell-vs-scala.html">Read more</a>

<h4><a href="../posts/2014-02-21-learning-agda-to-be-a-better-haskell-programmer.html">Learning Agda to be a better Haskell programmer</a></h4> - February 21, 2014
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - Learning Agda to be a better Haskell programmer</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Learning Agda to be a better Haskell programmer</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on February 21, 2014
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/Haskell.html">Haskell</a>, <a href="../tags/Agda.html">Agda</a>, <a href="../tags/dependent%20type.html">dependent type</a>
      
  </div>

<p>In my previous post <a href="https://kseo.github.io/posts/2014-02-17-learning-prolog-to-be-a-better-haskell-programmer.html">Learning Prolog to be a better Haskell programmer</a>, I advocated learning Prolog is quite helpful to get more intuitions on Haskell type-level programming.</p>
<p>I think a good next step is to learn a dependent typed programming language such as <a href="http://wiki.portal.chalmers.se/agda/pmwiki.php">Agda</a> or <a href="https://code.google.com/archive/p/epigram/">Epigram</a>. As learning Haskell is a good way to develop oneself as a better Java programmer, learning a dependent typed programming language is a good way to develop oneself as a better Haskell programmer.</p>
<p>Among many dependent typed programming languages, I recommend Agda simply because its surface syntax is quite similar to that of Haskell. Because dependent typed programming languages in general are not mature enough to perform day-to-day programming task and most of them are more or less equivalent in powers, choosing a syntactically familiar language helps you understand more advanced type system behind the syntax.</p>
<p>As the name “dependent type” implies, the biggest difference lies in the type system. While Haskell’s type system strictly splits values and types, Agda blurs the distinction between types and values. Type level programming in Haskell with type families or functional dependencies is esoteric at best, but type level programming in Agda is a norm.</p>
<p>For example, it is possible to define a type of lists of a certain length. In this setting, it is a type error to pass an empty list to head.</p>
<div class="sourceCode"><pre class="sourceCode agda"><code class="sourceCode agda"><span class="kw">data</span> Vec <span class="ot">(</span>A <span class="ot">:</span> <span class="dt">Set</span><span class="ot">)</span> <span class="ot">:</span> Nat <span class="ot">-&gt;</span> <span class="dt">Set</span> <span class="kw">where</span>
     [] <span class="ot">:</span> Vec A zero
     <span class="ot">_</span>::<span class="ot">_</span> <span class="ot">:</span> <span class="ot">{</span>n <span class="ot">:</span> Nat<span class="ot">}</span> <span class="ot">-&gt;</span> A <span class="ot">-&gt;</span> Vec A n <span class="ot">-&gt;</span> Vec A <span class="ot">(</span>suc n<span class="ot">)</span>
 
head <span class="ot">:</span> <span class="ot">{</span>A <span class="ot">:</span> <span class="dt">Set</span><span class="ot">}{</span>n <span class="ot">:</span> Nat<span class="ot">}</span> <span class="ot">-&gt;</span> Vec A <span class="ot">(</span>suc n<span class="ot">)</span> <span class="ot">-&gt;</span> A
head <span class="ot">(</span>x :: xs<span class="ot">)</span> <span class="ot">=</span> x</code></pre></div>
<p>Please refer to <a href="http://www.cse.chalmers.se/~ulfn/darcs/AFP08/LectureNotes/AgdaIntro.pdf">Dependently Typed Programming in Agda</a> and <a href="https://www.youtube.com/playlist?p=B7F836675DCE009C">Daniel Peebles’s introduction on Agda</a> for more information on Agda.</p>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2014-02-21-learning-agda-to-be-a-better-haskell-programmer.html";
    this.page.identifier = "/posts/2014-02-21-learning-agda-to-be-a-better-haskell-programmer.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2014-02-21-learning-agda-to-be-a-better-haskell-programmer.html">Read more</a>

<h4><a href="../posts/2014-02-17-learning-prolog-to-be-a-better-haskell-programmer.html">Learning Prolog to be a better Haskell programmer</a></h4> - February 17, 2014
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - Learning Prolog to be a better Haskell programmer</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Learning Prolog to be a better Haskell programmer</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on February 17, 2014
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/Haskell.html">Haskell</a>, <a href="../tags/prolog.html">prolog</a>, <a href="../tags/type-level%20programming.html">type-level programming</a>, <a href="../tags/functional%20dependencies.html">functional dependencies</a>, <a href="../tags/type%20families.html">type families</a>
      
  </div>

<p>While learning some advanced topics of the Haskell type system, I found type level programming is reminiscent of logic programming.</p>
<p>For example, <a href="http://www.cse.chalmers.se/~hallgren/Papers/wm01.html">Fun with Functional Dependencies</a> shows how to implement insertion sort using functional dependencies in a programming style similar to Prolog. <a href="https://wiki.haskell.org/Simonpj/Talk:FunWithTypeFuns">Fun with Type Functions</a> also shows a similar example using type families.</p>
<p>This similarity is not a coincidence because of the correspondence between a logic system and a type system, which is known as <a href="https://en.wikipedia.org/wiki/Curry%E2%80%93Howard_correspondence">Curry-Howard isomorphism</a>.</p>
<p>Lesson: Learn Prolog to be a better Haskell programmer!</p>
<h2 id="references">References</h2>
<p>There is <a href="https://mail.haskell.org/pipermail/haskell-cafe/2010-June/079412.html">a discussion</a> on the Haskell-cafe.</p>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2014-02-17-learning-prolog-to-be-a-better-haskell-programmer.html";
    this.page.identifier = "/posts/2014-02-17-learning-prolog-to-be-a-better-haskell-programmer.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2014-02-17-learning-prolog-to-be-a-better-haskell-programmer.html">Read more</a>

<h4><a href="../posts/2014-02-12-data-map-vs-data-intmap.html">Data.Map vs Data.IntMap</a></h4> - February 12, 2014
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - Data.Map vs Data.IntMap</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Data.Map vs Data.IntMap</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on February 12, 2014
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/Haskell.html">Haskell</a>, <a href="../tags/Data.Map.html">Data.Map</a>, <a href="../tags/Data.IntMap.html">Data.IntMap</a>
      
  </div>

<p>A map is the one of most widely used data structures in many applications. Thus, many language runtimes provide an efficient implementation of a map. In a purely functional programming language, map is usually implemented as a balanced binary tree. Haskell is no exception here and the implementation of Haskell’s <code>Data.Map</code> is based on size balanced binary trees described in</p>
<ul>
<li>Stephen Adams, <a href="http://www.swiss.ai.mit.edu/~adams/BB/">“Efficient sets: a balancing act”</a>, Journal of Functional Programming 3(4):553-562, October 1993, .</li>
<li>J. Nievergelt and E.M. Reingold, “Binary search trees of bounded balance”, SIAM journal of computing 2(1), March 1973.</li>
</ul>
<p><code>Data.Map</code> is parameterized over key and value types, so that you can use any type you want as long as key is an instance of <code>Ord</code> type class. So, for example, you can use <code>Int</code> as the key type and store any type you want.</p>
<p>However, Haskell also provides a special version <code>Data.IntMap</code> for <code>Int</code> key. It seems redundant at first, but <code>Data.IntMap</code> is different from <code>Data.Map</code> in that it supports efficient merging of two maps. The implementation of <code>Data.IntMap</code> is described in</p>
<ul>
<li>Chris Okasaki and Andy Gill, <a href="http://citeseer.ist.psu.edu/okasaki98fast.html">“Fast Mergeable Integer Maps”</a>, Workshop on ML, September 1998, pages 77-86,</li>
<li>D.R. Morrison, “/PATRICIA — Practical Algorithm To Retrieve Information Coded In Alphanumeric/”, Journal of the ACM, 15(4), October 1968, pages 514-534.</li>
</ul>
<p>The author of <code>Data.IntMap</code> mentions that insertions and deletions of <code>Data.IntMap</code> when compared to a generic size-balanced map implementation are also much faster. This observation suggests that we should use <code>Data.IntMap</code> whenever possible whether or not we need union or intersection of twp maps.</p>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2014-02-12-data-map-vs-data-intmap.html";
    this.page.identifier = "/posts/2014-02-12-data-map-vs-data-intmap.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2014-02-12-data-map-vs-data-intmap.html">Read more</a>

<h4><a href="../posts/2014-02-10-record-wildcards.html">Record wildcards</a></h4> - February 10, 2014
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - Record wildcards</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Record wildcards</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on February 10, 2014
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/Haskell.html">Haskell</a>, <a href="../tags/record%20wildcards.html">record wildcards</a>, <a href="../tags/language%20extension.html">language extension</a>
      
  </div>

<p>Haskell record syntax is a bit verbose. For records with many fields, it is tiresome to write each field individually in a record pattern, as in</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">data</span> <span class="dt">C</span> <span class="fu">=</span> <span class="dt">C</span> {<span class="ot">a ::</span> <span class="dt">Int</span>,<span class="ot"> b ::</span> <span class="dt">Int</span>,<span class="ot"> c ::</span> <span class="dt">Int</span>,<span class="ot"> d ::</span> <span class="dt">Int</span>}

f (<span class="dt">C</span> {a <span class="fu">=</span> <span class="dv">1</span>, b <span class="fu">=</span> b, c <span class="fu">=</span> c, d <span class="fu">=</span> d}) <span class="fu">=</span> b <span class="fu">+</span> c <span class="fu">+</span> d</code></pre></div>
<p><a href="https://ocharles.org.uk/blog/posts/2014-12-04-record-wildcards.html">Record wildcard syntax</a> lets us use <code>..</code> in a record pattern, which simplifies pattern <code>f=f</code> to <code>f</code>. The above pattern can be rewritten with record wildcards syntax</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">f (<span class="dt">C</span> {a <span class="fu">=</span> <span class="dv">1</span>, <span class="fu">..</span>}) <span class="fu">=</span> b <span class="fu">+</span> c <span class="fu">+</span> d</code></pre></div>
<p>This simple example does not show the merit of record wildcards vividly. Let’s see a real world example. <a href="http://hackage.haskell.org/package/hs-java">hs-java</a> is a package written by Ilya V. Portnov, which provides data types for Java .class files format and functions to assemble/disassemble Java bytecode.</p>
<p>The datatype for a JVM class file is <code>Class</code>, which has many fields as in</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">data</span> <span class="dt">Class</span> stage <span class="fu">=</span> <span class="dt">Class</span> {
<span class="ot">  magic ::</span> <span class="dt">Word32</span>,                         <span class="co">-- ^ Magic value: 0xCAFEBABE</span>
<span class="ot">  minorVersion ::</span> <span class="dt">Word16</span>,
<span class="ot">  majorVersion ::</span> <span class="dt">Word16</span>,
<span class="ot">  constsPoolSize ::</span> <span class="dt">Word16</span>,                <span class="co">-- ^ Number of items in constants pool</span>
<span class="ot">  constsPool ::</span> <span class="dt">Pool</span> stage,                <span class="co">-- ^ Constants pool itself</span>
<span class="ot">  accessFlags ::</span> <span class="dt">AccessFlags</span> stage,        <span class="co">-- ^ See @JVM.Types.AccessFlag@</span>
<span class="ot">  thisClass ::</span> <span class="dt">Link</span> stage <span class="dt">B.ByteString</span>,    <span class="co">-- ^ Constants pool item index for this class</span>
<span class="ot">  superClass ::</span> <span class="dt">Link</span> stage <span class="dt">B.ByteString</span>,   <span class="co">-- ^ --/-- for super class, zero for java.lang.Object</span>
<span class="ot">  interfacesCount ::</span> <span class="dt">Word16</span>,               <span class="co">-- ^ Number of implemented interfaces</span>
<span class="ot">  interfaces ::</span> [<span class="dt">Link</span> stage <span class="dt">B.ByteString</span>], <span class="co">-- ^ Constants pool item indexes for implemented interfaces</span>
<span class="ot">  classFieldsCount ::</span> <span class="dt">Word16</span>,              <span class="co">-- ^ Number of class fileds</span>
<span class="ot">  classFields ::</span> [<span class="dt">Field</span> stage],            <span class="co">-- ^ Class fields</span>
<span class="ot">  classMethodsCount ::</span> <span class="dt">Word16</span>,             <span class="co">-- ^ Number of class methods</span>
<span class="ot">  classMethods ::</span> [<span class="dt">Method</span> stage],          <span class="co">-- ^ Class methods</span>
<span class="ot">  classAttributesCount ::</span> <span class="dt">Word16</span>,          <span class="co">-- ^ Number of class attributes</span>
<span class="ot">  classAttributes ::</span> <span class="dt">Attributes</span> stage      <span class="co">-- ^ Class attributes</span>
  }</code></pre></div>
<p>It is declared as an instance of <a href="http://hackage.haskell.org/package/binary-0.7.1.0/docs/Data-Binary.html">Binary</a> class for serialization. Its put method uses the record wildcards syntax not to repeat field names as in the following:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">instance</span> <span class="dt">Binary</span> (<span class="dt">Class</span> <span class="dt">File</span>) <span class="kw">where</span>
  put (<span class="dt">Class</span> {<span class="fu">..</span>}) <span class="fu">=</span> <span class="kw">do</span>
    put magic
    put minorVersion
    put majorVersion
    putPool constsPool
    put accessFlags
    put thisClass
    put superClass
    put interfacesCount
    forM_ interfaces put
    put classFieldsCount
    forM_ classFields put
    put classMethodsCount
    forM_ classMethods put
    put classAttributesCount
    forM_ (attributesList classAttributes) put</code></pre></div>
<p>You can see the real difference by comparing this with a more verbose version which does not use record wildcards.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">instance</span> <span class="dt">Binary</span> (<span class="dt">Class</span> <span class="dt">File</span>) <span class="kw">where</span>
  put (<span class="dt">Class</span> {magic<span class="fu">=</span>magic, minorVersion<span class="fu">=</span>minorVersion, majorVersion<span class="fu">=</span>majorVersion, constsPool<span class="fu">=</span>constsPool, accessFlags<span class="fu">=</span>accessFlags, thisCla    ss<span class="fu">=</span>thisClass, superClass<span class="fu">=</span>superClass, interfacesCount<span class="fu">=</span>interfacesCount, interfaces<span class="fu">=</span>interfaces, classFieldsCount<span class="fu">=</span>classFieldsCount, classFie    lds<span class="fu">=</span>classFields, classMethodsCount<span class="fu">=</span>classMethodsCount, classMethods<span class="fu">=</span>classMethods, classAttributesCount<span class="fu">=</span>classAttributesCount, classAttributes<span class="fu">=</span>classAttributes}) <span class="fu">=</span> <span class="kw">do</span>
 <span class="fu">...</span></code></pre></div>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2014-02-10-record-wildcards.html";
    this.page.identifier = "/posts/2014-02-10-record-wildcards.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2014-02-10-record-wildcards.html">Read more</a>

<h4><a href="../posts/2014-02-06-multi-line-strings-in-haskell.html">Multi-line strings in Haskell</a></h4> - February  6, 2014
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - Multi-line strings in Haskell</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Multi-line strings in Haskell</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on February  6, 2014
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/Haskell.html">Haskell</a>, <a href="../tags/multi-line%20string.html">multi-line string</a>, <a href="../tags/quasiquotation.html">quasiquotation</a>
      
  </div>

<p>Haskell supports multi-line string literals in several ways.</p>
<h2 id="unlines">unlines</h2>
<p><a href="http://hackage.haskell.org/package/base-4.6.0.1/docs/Prelude.html#v:unlines">unlines</a> joins lines, after appending a terminating newline to each.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">multi <span class="fu">=</span> unlines [<span class="st">&quot;line1&quot;</span>, <span class="st">&quot;line2&quot;</span>, <span class="st">&quot;line3&quot;</span>]</code></pre></div>
<h2 id="multi-line-string-literal">Multi-line string literal</h2>
<p>We should escape it using <code>\</code> and then another <code>\</code> where the string starts again.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">multi <span class="fu">=</span> <span class="st">&quot;line1\</span>
<span class="st">\line2\</span>
<span class="st">\line3&quot;</span></code></pre></div>
<h2 id="quasiquotation">Quasiquotation</h2>
<p>The <a href="http://hackage.haskell.org/package/raw-strings-qq">raw-strings-qq</a> package provides a quasiquoter for raw string literals. In addition to supporting multi-line string, it does not recognize escape sequences. So we don’t need to add <code>\</code> as in multi-line string literals. <code>{-# LANGUAGE QuasiQuotes #-}</code> is required to use this feature.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">{-# LANGUAGE QuasiQuotes #-}</span>
<span class="kw">import </span><span class="dt">Text.RawString.QQ</span>
multi <span class="fu">=</span> [r|line1
line2
line3|]</code></pre></div>
<p>I prefer quasiquotation because I use multi-line string literals for HTML/XML fragments and it is laborious to escape all special characters such as quotes.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">{-# LANGUAGE QuasiQuotes #-}</span>
<span class="kw">import </span><span class="dt">Text.RawString.QQ</span>
 
<span class="ot">multiline ::</span> <span class="dt">String</span>
multiline <span class="fu">=</span> [r|&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Auto-generated html formated source&lt;/TITLE&gt;
&lt;META HTTP-EQUIV=&quot;Content-Type&quot; CONTENT=&quot;text/html; charset=windows-1252&quot;&gt;
&lt;/HEAD&gt;
&lt;BODY LINK=&quot;800080&quot; BGCOLOR=&quot;#ffffff&quot;&gt;
&lt;P&gt; &lt;/P&gt;
&lt;PRE&gt;|]</code></pre></div>
<p>There are other quasi-quote packages such as <a href="http://hackage.haskell.org/package/interpolatedstring-qq">string-qq</a>, <a href="http://hackage.haskell.org/package/string-quote">string-quote</a> and <a href="http://hackage.haskell.org/package/interpolatedstring-qq">interpolatedstring-qq</a>.</p>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2014-02-06-multi-line-strings-in-haskell.html";
    this.page.identifier = "/posts/2014-02-06-multi-line-strings-in-haskell.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2014-02-06-multi-line-strings-in-haskell.html">Read more</a>

<h4><a href="../posts/2014-02-06-default-values-of-haskell-types.html">Default values of Haskell Types</a></h4> - February  6, 2014
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - Default values of Haskell Types</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Default values of Haskell Types</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on February  6, 2014
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/Haskell.html">Haskell</a>, <a href="../tags/default%20value.html">default value</a>
      
  </div>

<p>Java types have default values. If you don’t explicitly assign a value in a field declaration, it gets its default value of the given type. For example, the default value of <code>int</code> is <code>0</code> and the default value of <code>boolean</code> is <code>false</code>.</p>
<p>On the contrary, Haskell types do not provide default values. This is natural because Haskell does not destructively update a variable initialized with the the default value.</p>
<p>However, it is handy to have a default value in some cases such as a record with many fields. Haskell libraries often provide a default value for such a record for the ease of construction. For example, <a href="http://bscarlet.github.io/llvm-general/3.3.8.2/doc/html/llvm-general-pure/index.html">llvm-general-pure</a> provides <code>defaultModule</code>, which is the default value of <code>Module</code>. The data constructor <code>Module</code> has 4 fields:</p>
<ul>
<li><code>moduleName :: String</code></li>
<li><code>moduleDataLayout :: Maybe DataLayout</code> – a DataLayout, if specified, must match that of the eventual code generator</li>
<li><code>moduleTargetTriple :: Maybe String</code></li>
<li><code>moduleDefinitions :: [Definition]</code></li>
</ul>
<p>Using <code>defaultModule</code>, you don’t need to supply all these fields. You can construct a <code>Module</code> value using Haskell record update syntax as in the following:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">defaultModule { moduleName<span class="fu">=</span><span class="st">&quot;mymodule&quot;</span> }</code></pre></div>
<p>The <a href="http://hackage.haskell.org/package/data-default">data-default</a> package provides a type class <code>Default</code>, which is useful for this purpose. If a given type is an instance of <code>Default</code>, you can get its default value using <code>def</code> method. Instances are provided for <code>()</code>, <code>Set</code>, <code>Map</code>, <code>Int</code>, <code>Integer</code>, <code>Float</code>, <code>Double</code>, and many others.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="dt">Prelude</span> <span class="dt">Data.Default</span><span class="fu">&gt;</span><span class="ot"> def ::</span> <span class="dt">Int</span>
<span class="dv">0</span>
<span class="dt">Prelude</span> <span class="dt">Data.Default</span><span class="fu">&gt;</span><span class="ot"> def ::</span> [a]
[]
<span class="dt">Prelude</span> <span class="dt">Data.Default</span><span class="fu">&gt;</span><span class="ot"> def ::</span> <span class="dt">Double</span>
<span class="fl">0.0</span></code></pre></div>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2014-02-06-default-values-of-haskell-types.html";
    this.page.identifier = "/posts/2014-02-06-default-values-of-haskell-types.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2014-02-06-default-values-of-haskell-types.html">Read more</a>

<h4><a href="../posts/2014-02-03-top-30-haskell-packages-with-most-reverse-dependencies.html">Top 30 Haskell packages with most reverse dependencies</a></h4> - February  3, 2014
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - Top 30 Haskell packages with most reverse dependencies</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Top 30 Haskell packages with most reverse dependencies</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on February  3, 2014
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/Haskell.html">Haskell</a>, <a href="../tags/package.html">package</a>, <a href="../tags/reverse%20dependencies.html">reverse dependencies</a>
      
  </div>

<p><a href="http://packdeps.haskellers.com/reverse">Reverse Dependencies</a> shows the reverse dependencies of each Haskell package (those packages that depend upon it). I <a href="https://docs.google.com/spreadsheets/d/1-wbCAyoloUaTXV-WOzwdhyMQV6AiwUwTgphCODMau4k/pub?output=html">sorted the list</a> to check the packages with most reverse dependencies. Here are top 30 Haskell packages among 2348 packages.</p>
<ol style="list-style-type: decimal">
<li>base 5961</li>
<li>containers 2110</li>
<li>bytestring 2018</li>
<li>mtl 1664</li>
<li>directory 1068</li>
<li>text 979</li>
<li>transformers 971</li>
<li>filepath 934</li>
<li>time 723</li>
<li>array 696</li>
<li>process 628</li>
<li>QuickCheck 621</li>
<li>network 581</li>
<li>parsec 577</li>
<li>random 537</li>
<li>HUnit 491</li>
<li>template-haskell 488</li>
<li>vector 429</li>
<li>binary 399</li>
<li>test-framework 379</li>
<li>utf8-string 334</li>
<li>unix 331</li>
<li>old-locale 325</li>
<li>deepseq 323</li>
<li>pretty 288</li>
<li>stm 274</li>
<li>test-framework-quickcheck2 270</li>
<li>test-framework-hunit 264</li>
<li>attoparsec 263</li>
<li>aeson 254</li>
</ol>
<p>Though the list does not show the importance of each package, there is high chance that you need to use at least one of these packages when you write your own package. So to become a seasoned Haskell programmer, you need to get accustomed to these packages.</p>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2014-02-03-top-30-haskell-packages-with-most-reverse-dependencies.html";
    this.page.identifier = "/posts/2014-02-03-top-30-haskell-packages-with-most-reverse-dependencies.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2014-02-03-top-30-haskell-packages-with-most-reverse-dependencies.html">Read more</a>

<h4><a href="../posts/2014-02-03-data-typeable-and-data-dynamic-in-haskell.html">Data.Typeable and Data.Dynamic in Haskell</a></h4> - February  3, 2014
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - Data.Typeable and Data.Dynamic in Haskell</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Data.Typeable and Data.Dynamic in Haskell</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on February  3, 2014
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/Haskell.html">Haskell</a>, <a href="../tags/Data.Typeable.html">Data.Typeable</a>, <a href="../tags/Data.Dynamic.html">Data.Dynamic</a>, <a href="../tags/dynamic%20typing.html">dynamic typing</a>
      
  </div>

<p>This article is written in literate Haskell.</p>
<p><a href="http://hackage.haskell.org/package/base-4.6.0.1/docs/Data-Typeable.html">Data.Typeable</a> is a way to implement dynamic (delayed) type checking in Haskell using a <a href="http://www.haskell.org/haskellwiki/Heterogenous_collections#A_Universal_type">universal type</a>.</p>
<p>For example, you can implement a heterogenous list in Haskell. <code>toDyn</code> converts any <code>Typeable</code> instance into <code>Dynamic</code> which is similar to Java <code>Object</code> type. Any type that is an instance of <code>Typeable</code> class can be wrapped with <code>Dynamic</code> type.</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt;</span> <span class="kw">import </span><span class="dt">Data.Dynamic</span>
<span class="ot">&gt;</span> <span class="kw">import </span><span class="dt">Data.Maybe</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; hlist ::</span> [<span class="dt">Dynamic</span>]
<span class="ot">&gt;</span> hlist <span class="fu">=</span> [ toDyn (<span class="st">&quot;string&quot;</span><span class="ot"> ::</span> <span class="dt">String</span>)
<span class="ot">&gt;</span>         , toDyn (<span class="dv">7</span><span class="ot"> ::</span> <span class="dt">Int</span>)
<span class="ot">&gt;</span>         , toDyn (pi<span class="ot"> ::</span> <span class="dt">Double</span>)
<span class="ot">&gt;</span>         , toDyn <span class="ch">'x'</span>
<span class="ot">&gt;</span>         , toDyn (((), <span class="dt">Just</span> <span class="st">&quot;foo&quot;</span>)<span class="ot"> ::</span> ((), <span class="dt">Maybe</span> <span class="dt">String</span>))
<span class="ot">&gt;</span>         ]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; dyn ::</span> <span class="dt">Dynamic</span>
<span class="ot">&gt;</span> dyn <span class="fu">=</span> hlist <span class="fu">!!</span> <span class="dv">1</span></code></pre></div>
<p>To be precise, <code>hlist</code> is not actually a heterogenous list from the point of Haskell type system. It is just a homogenous list of <code>Dynamic</code>. The chapter 20, “Untyped Means Uni-Typed” of Harper’s textbook also emphasizes this observation: dynamic types (with typeable representations) are statically typed languages with only one type.</p>
<p>You can convert a <code>Dynamic</code> object back into an ordinary Haskell value using <code>fromDynamic</code>. Type checking is dynamic because it is delayed to runtime.</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; v ::</span> <span class="dt">Int</span>
<span class="ot">&gt;</span> v <span class="fu">=</span> <span class="kw">case</span> fromDynamic dyn <span class="kw">of</span>
<span class="ot">&gt;</span>         <span class="dt">Nothing</span> <span class="ot">-&gt;</span> error <span class="st">&quot;Type mismatch&quot;</span>
<span class="ot">&gt;</span>         <span class="dt">Just</span> x  <span class="ot">-&gt;</span> x</code></pre></div>
<p>You can make any type <code>Typeable</code> by adding <code>deriving Data.Typeable</code>. In GHC, you need to turn on <code>-XDeriveDataTypeable</code> option to make GHC automatically derive the instance for you.</p>
<p>The <code>Data.Typeable</code> class is used primarily for generic programming in the “Scrap Your Boilerplate (SYB)” style. I will write more on this later.</p>
<h1 id="references">References</h1>
<ul>
<li>Martín Abadi, Luca Cardelli, Benjamin Pierce and Gordon Plotkin, “<a href="http://www.hpl.hp.com/techreports/Compaq-DEC/SRC-RR-47.pdf">Dynamic Typing in a Statically Typed Language</a>”, ACM Transactions on Programming Languages and Systems (TOPLAS), 1991.</li>
<li>James Cheney and Ralf Hinze, “<a href="https://www.cs.ox.ac.uk/people/ralf.hinze/publications/HW02.pdf">A lightweight implementation of generics and dynamics</a>”, Haskell ’02: Proceedings of the 2002 ACM SIGPLAN Workshop on Haskell, 2002.</li>
<li>Lammel, Ralf and Jones, Simon Peyton, “<a href="http://research.microsoft.com/en-us/um/people/simonpj/papers/hmap/hmap.ps">Scrap your boilerplate: a practical design pattern for generic programming</a>”, TLDI ’03: Proceedings of the 2003 ACM SIGPLAN International Workshop on Types in Languages Design and Implementation, 2003</li>
<li>Harper, 2011, Practical Foundations for Programming Languages.</li>
</ul>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2014-02-03-data-typeable-and-data-dynamic-in-haskell.html";
    this.page.identifier = "/posts/2014-02-03-data-typeable-and-data-dynamic-in-haskell.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2014-02-03-data-typeable-and-data-dynamic-in-haskell.html">Read more</a>

<h4><a href="../posts/2014-01-30-implementing-union-find-in-haskell.html">Implementing Union-Find algorithms in Haskell</a></h4> - January 30, 2014
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - Implementing Union-Find algorithms in Haskell</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Implementing Union-Find algorithms in Haskell</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on January 30, 2014
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/Haskell.html">Haskell</a>, <a href="../tags/ST%20monad.html">ST monad</a>, <a href="../tags/union%20find.html">union find</a>
      
  </div>

<p>The union/find algorithm makes critical use of updatable states. Its efficiency relies on the set representations being simplified each time the structure is examined. Purely functional languages, which lack updatable states seem inherently inefficient to implement the algorithm.</p>
<p>Fortunately, we can implement the algorithm efficiently in Haskell with the help of <code>ST</code> monad which provides support for strict state threads. It is described in the PLDI ’94 paper by John Launchbury and Simon Peyton Jones <a href="http://research.microsoft.com/~simonpj/Papers/lazy-functional-state-threads.ps.Z">Lazy Functional State Threads</a>.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">data</span> <span class="dt">UnionFind</span> s <span class="fu">=</span> <span class="dt">UnionFind</span> {
<span class="ot">    ids::</span> <span class="dt">STUArray</span> s <span class="dt">Int</span> <span class="dt">Int</span>
  ,<span class="ot"> szs::</span> <span class="dt">STUArray</span> s <span class="dt">Int</span> <span class="dt">Int</span>
  }
 
<span class="ot">newUnionFind ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">ST</span> s (<span class="dt">UnionFind</span> s)
newUnionFind n <span class="fu">=</span> liftM2 <span class="dt">UnionFind</span> (newListArray (<span class="dv">0</span>, n<span class="fu">-</span><span class="dv">1</span>) [<span class="dv">0</span><span class="fu">..</span>n<span class="fu">-</span><span class="dv">1</span>]) (newArray (<span class="dv">0</span>, n<span class="fu">-</span><span class="dv">1</span>) <span class="dv">1</span>)
 
<span class="ot">find ::</span> (<span class="dt">UnionFind</span> s) <span class="ot">-&gt;</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">ST</span> s <span class="dt">Bool</span>
find uf p q <span class="fu">=</span> liftM2 (<span class="fu">==</span>) (root uf p) (root uf q)
 
<span class="ot">root ::</span> (<span class="dt">UnionFind</span> s) <span class="ot">-&gt;</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">ST</span> s <span class="dt">Int</span>
root uf i <span class="fu">=</span> <span class="kw">do</span>
    id <span class="ot">&lt;-</span> readArray (ids uf) i
    <span class="kw">if</span> (id <span class="fu">/=</span> i)
        <span class="kw">then</span> <span class="kw">do</span>
            gpid <span class="ot">&lt;-</span> readArray (ids uf) id
            writeArray (ids uf) i gpid
            root uf id
        <span class="kw">else</span> return i
 
<span class="ot">unite ::</span> (<span class="dt">UnionFind</span> s) <span class="ot">-&gt;</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">ST</span> s ()
unite uf p q <span class="fu">=</span> <span class="kw">do</span>
    i <span class="ot">&lt;-</span> root uf p
    j <span class="ot">&lt;-</span> root uf q
    szi <span class="ot">&lt;-</span> readArray (szs uf) i
    szj <span class="ot">&lt;-</span> readArray (szs uf) j
    <span class="kw">if</span> (szi <span class="fu">&lt;</span> szj)
        <span class="kw">then</span> <span class="kw">do</span>
            writeArray (ids uf) i j
            writeArray (szs uf) j (szi <span class="fu">+</span> szj)
        <span class="kw">else</span> <span class="kw">do</span>
            writeArray (ids uf) j i
            writeArray (szs uf) i (szj <span class="fu">+</span> szi)</code></pre></div>
<p>The code above implements the weighted quick-union with path compression specified in <a href="http://www.cs.princeton.edu/~rs/AlgsDS07/01UnionFind.pdf">Union-Find Algorithms</a>. You can see that the code is almost the same to the Java code. Because <a href="http://www.haskell.org/haskellwiki/Monad/ST">ST monad</a> uses mutable memory internally, the behavior is also the same to that of imperative languages.</p>
<p>You can run the code with <code>runST</code> function.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">main <span class="fu">=</span> print <span class="fu">$</span> runST <span class="fu">$</span> <span class="kw">do</span>
    uf <span class="ot">&lt;-</span> newUnionFind <span class="dv">10</span>
    unite uf <span class="dv">3</span> <span class="dv">4</span> <span class="co">-- 0, 1, 2, {3, 4}, 5, 6, 7, 8, 9</span>
    unite uf <span class="dv">4</span> <span class="dv">9</span> <span class="co">-- 0, 1, 2, {3, 4, 9}, 5, 6, 7, 8</span>
    unite uf <span class="dv">8</span> <span class="dv">0</span> <span class="co">-- {0, 8}, 1, 2, {3, 4, 9}, 5, 6, 7, 8</span>
    unite uf <span class="dv">2</span> <span class="dv">3</span> <span class="co">-- {0, 8}, 1, {2, 3, 4, 9}, 5, 6, 7</span>
    unite uf <span class="dv">5</span> <span class="dv">6</span> <span class="co">-- {0, 8}, 1, {2, 3, 4, 9}, {5, 6}, 7</span>
    unite uf <span class="dv">5</span> <span class="dv">9</span> <span class="co">-- {0, 8}, 1, {2, 3, 4, 5, 6, 9}, 7</span>
    unite uf <span class="dv">7</span> <span class="dv">3</span> <span class="co">-- {0, 8}, 1, {2, 3, 4, 5, 6, 7, 9}</span>
    unite uf <span class="dv">4</span> <span class="dv">8</span> <span class="co">-- 1, {0, 2, 3, 4, 5, 6, 7, 8, 9}</span>
    find uf <span class="dv">1</span> <span class="dv">2</span> <span class="co">-- False</span></code></pre></div>
<p>The complete source code is <a href="https://gist.github.com/kseo/8693028">here</a>.</p>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2014-01-30-implementing-union-find-in-haskell.html";
    this.page.identifier = "/posts/2014-01-30-implementing-union-find-in-haskell.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2014-01-30-implementing-union-find-in-haskell.html">Read more</a>

<h4><a href="../posts/2014-01-28-calling-c-library-functions-dynamically-in-haskell.html">Calling C library functions dynamically in Haskell</a></h4> - January 28, 2014
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - Calling C library functions dynamically in Haskell</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Calling C library functions dynamically in Haskell</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on January 28, 2014
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/Haskell.html">Haskell</a>, <a href="../tags/FFI.html">FFI</a>, <a href="../tags/C.html">C</a>
      
  </div>

<p>Haskell FFI is used to call functions from C and for C to call Haskell functions. A classic example from Haskell Wiki page <a href="https://wiki.haskell.org/FFI_Introduction">FFI Introduction</a> is to call a C library function, <code>sin</code> from Haskell. In this method, you have to declare the type of C function you want to call using <code>foreign import ccall</code>.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">{-# LANGUAGE ForeignFunctionInterface #-}</span>
<span class="kw">import </span><span class="dt">Foreign.C</span>
 
foreign <span class="kw">import </span>ccall &quot;sin&quot; c_sin :: <span class="dt">CDouble</span> -&gt; <span class="dt">CDouble</span>
  
<span class="ot">sin1 ::</span> <span class="dt">Double</span> <span class="ot">-&gt;</span> <span class="dt">Double</span>
sin1 d <span class="fu">=</span> realToFrac (c_sin (realToFrac d))</code></pre></div>
<p>What if you don’t know the type of a C function you want to call until you run your program (e.g., JIT compilation). You can’t use <code>foreign import ccall</code> because you don’t know the function type statically. In this case, you can use the <a href="http://hackage.haskell.org/package/libffi-0.1/docs/Foreign-LibFFI.html">Haskell binding for libffi</a>, a Portable Foreign Function Interface Library.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">import </span><span class="dt">System.Posix.DynamicLinker</span>
<span class="kw">import </span><span class="dt">Foreign.C</span>
<span class="kw">import </span><span class="dt">Foreign.Ptr</span>
<span class="kw">import </span><span class="dt">Foreign.LibFFI</span>
 
<span class="ot">sin2 ::</span> <span class="dt">Double</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">Double</span>
sin2 d <span class="fu">=</span> <span class="kw">do</span>
    sin <span class="ot">&lt;-</span> dlsym <span class="dt">Default</span> <span class="st">&quot;sin&quot;</span>
    ret <span class="ot">&lt;-</span> callFFI sin retCDouble [argCDouble (realToFrac d)]
    return <span class="fu">$</span> realToFrac ret</code></pre></div>
<p>Now you don’t need to declare it using <code>foreign import ccall</code>. You can just pass the return type and the list of argument types to <code>callFFI</code> function.</p>
<p>So far so good, but there is one problem with this approach. <code>sin2</code> is no longer a pure function. The return type must be <code>IO Double</code> because calling <code>callFFI</code> function requires IO monad. If you call a impure C function with side effects, this is okay though.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">callFFI ::</span> <span class="dt">FunPtr</span> a <span class="ot">-&gt;</span> <span class="dt">RetType</span> b <span class="ot">-&gt;</span> [<span class="dt">Arg</span>] <span class="ot">-&gt;</span> <span class="dt">IO</span> b</code></pre></div>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2014-01-28-calling-c-library-functions-dynamically-in-haskell.html";
    this.page.identifier = "/posts/2014-01-28-calling-c-library-functions-dynamically-in-haskell.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2014-01-28-calling-c-library-functions-dynamically-in-haskell.html">Read more</a>

<h4><a href="../posts/2014-01-27-using-llvm-in-haskell.html">Using LLVM in Haskell</a></h4> - January 27, 2014
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - Using LLVM in Haskell</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Using LLVM in Haskell</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on January 27, 2014
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/Haskell.html">Haskell</a>, <a href="../tags/LLVM.html">LLVM</a>
      
  </div>

<p>Stephen Diehl’s <a href="http://www.stephendiehl.com/llvm/">Implementing a JIT Compiled Language with Haskell and LLVM</a> is a good introductory material on how to use LLVM in Haskell. It explains how to build a compiler for a toy language, Kaleidoscope in Haskell.</p>
<p>Because LLVM is a compiler infrastructure written in C++, we need a Haskell binding for LLVM. The tutorial uses <a href="http://bscarlet.github.io/llvm-general/3.3.8.2/doc/html/llvm-general/index.html">llvm-general</a>. llvm-general depends on another package named <a href="http://bscarlet.github.io/llvm-general/3.3.8.2/doc/html/llvm-general-pure/index.html">llvm-general-pure</a> which provides a pure Haskell AST (no FFI needed) for <a href="http://llvm.org/docs/LangRef.html">LLVM IR</a>. BTW, Bryan O’Sullivan’s <a href="https://github.com/bos/llvm">LLVM binding</a> is deprecated in favor of llvm-general.</p>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2014-01-27-using-llvm-in-haskell.html";
    this.page.identifier = "/posts/2014-01-27-using-llvm-in-haskell.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2014-01-27-using-llvm-in-haskell.html">Read more</a>

<h4><a href="../posts/2014-01-27-GHC-typecheck-build.html">GHC typecheck build (no codegen)</a></h4> - January 27, 2014
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - GHC typecheck build (no codegen)</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>GHC typecheck build (no codegen)</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on January 27, 2014
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/Haskell.html">Haskell</a>, <a href="../tags/GHC.html">GHC</a>, <a href="../tags/build.html">build</a>
      
  </div>

<p>When programming in Haskell, I rebuild my program as frequently as possible to check if there is any type error. This is a good practice because Haskell finds most of bugs just by type checking.</p>
<p>However, as a program gets bigger, the longer it takes to build the program. This is problematic for a large project. Fortunately, GHC provides <code>-fno-code</code> option. When this option is given, GHC omits code generation and only performs type checking.</p>
<p>In combination with <code>-fforce-recomp</code>, one can force typecheck build with the following command:</p>
<pre><code>cabal build --ghc-options=&quot;-fforce-recomp -fno-code&quot;</code></pre>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2014-01-27-GHC-typecheck-build.html";
    this.page.identifier = "/posts/2014-01-27-GHC-typecheck-build.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2014-01-27-GHC-typecheck-build.html">Read more</a>

<h4><a href="../posts/2014-01-26-swtiching-from-monads-to-applicative-functors.html">Switching from monads to applicative functors</a></h4> - January 26, 2014
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - Switching from monads to applicative functors</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Switching from monads to applicative functors</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on January 26, 2014
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/Haskell.html">Haskell</a>, <a href="../tags/monad.html">monad</a>, <a href="../tags/applicative%20functor.html">applicative functor</a>
      
  </div>

<p>Many applications of monads actually do not require monads but only applicative functors. Monads allow us to run actions depending on the results of earlier actions, but not all applications of monads need this extended functionality.</p>
<p>It is better to use applicative functors where possible because there are some advantages of applicative functors. <a href="http://www.haskell.org/haskellwiki/Applicative_functor#Some_advantages_of_applicative_functors">Applicative functor on the Haskell Wiki</a> mentions two:</p>
<ul>
<li><p>Code that uses only on the <code>Applicative</code> interface are more general than ones uses the <code>Monad</code> interface, because there are more applicative functors than monads. The <code>ZipList</code> is an applicative functor on lists, where <code>liftA2</code> is implemented by <code>zipWith</code>. It is a typical example of an applicative functor that is not a monad.</p></li>
<li><p>Programming with <code>Applicative</code> has a more applicative/functional feel. Especially for newbies, it may encourage functional style even when programming with effects. <code>Monad</code> programming with do notation encourages a more sequential &amp; imperative style.</p></li>
</ul>
<p>There is another advantage. Applicative functors do not need special transformers because they can be combined in a generic way.</p>
<p>But there is a problem. It is usually not easy to decide if we need monads or applicative functors up front. You ambitiously start with applicative functors and find later that you actually needed monads. Sad!</p>
<p>Here is my tip. I start with monads but use only <code>return</code>, <code>ap</code>, <code>liftM</code>, <code>liftM2</code>, … instead of <code>do</code>, <code>&gt;&gt;=</code>. The most common pattern is</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">do</span> x <span class="ot">&lt;-</span> fx
   y <span class="ot">&lt;-</span> fy
   return (g x y)</code></pre></div>
<p>This can be rewritten as <code>liftM2 g fx fy</code>. Once you are sure that you need only those monad methods, you can mechanically switch from monads to applicative functors using the following translation table:</p>
<ul>
<li><code>import Control.Monad</code> -&gt; <code>import Control.Applicative</code></li>
<li><code>return</code> -&gt; <code>pure</code></li>
<li><code>ap</code> -&gt; -&gt; <code>(&lt;*&gt;)</code></li>
<li><code>liftM</code> -&gt; <code>liftA</code> or <code>(&lt;$&gt;)</code></li>
<li><code>liftM2</code> -&gt; <code>liftA2</code></li>
<li><code>(Monad m =&gt;)</code> -&gt; <code>(Applicative f =&gt;)</code></li>
</ul>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2014-01-26-swtiching-from-monads-to-applicative-functors.html";
    this.page.identifier = "/posts/2014-01-26-swtiching-from-monads-to-applicative-functors.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2014-01-26-swtiching-from-monads-to-applicative-functors.html">Read more</a>

<h4><a href="../posts/2014-01-24-using-string-literal-for-symbols.html">Using string literal for symbols</a></h4> - January 24, 2014
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - Using string literal for symbols</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Using string literal for symbols</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on January 24, 2014
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/Haskell.html">Haskell</a>, <a href="../tags/string%20literal.html">string literal</a>
      
  </div>

<p>In writing a compiler or an interpreter, it is common to define a symbol or identifier type which is distinct from <code>String</code> to make it more type-safe.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">newtype</span> <span class="dt">Symbol</span> <span class="fu">=</span> <span class="dt">Symbol</span> <span class="dt">String</span></code></pre></div>
<p>Now <code>String</code> and <code>Symbol</code> are distinct types and we can’t accidentally mix two. But it also means that we have to use <code>Symbol</code> constructor whenever we need to create a symbol from a string literal.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="dt">Symbol</span> <span class="st">&quot;main&quot;</span></code></pre></div>
<p>You can avoid this labor using the GHC extension, <a href="https://kseo.github.io/posts/2014-01-15-overloaded-string-literals.html">OverloadedStrings</a>. By making <code>Symbol</code> an instance of <code>IsString</code>, GHC automatically coerces a string literal into a symbol.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">{-# LANGUAGE OverloadedStrings #-}</span>
<span class="kw">import </span><span class="dt">Data.String</span>

<span class="kw">instance</span> <span class="dt">IsString</span> <span class="dt">Symbol</span> <span class="kw">where</span>
    fromString <span class="fu">=</span> <span class="dt">Symbol</span> <span class="fu">.</span> fromString

<span class="ot">s ::</span> <span class="dt">Symbol</span>
s <span class="fu">=</span> <span class="st">&quot;hello&quot;</span></code></pre></div>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2014-01-24-using-string-literal-for-symbols.html";
    this.page.identifier = "/posts/2014-01-24-using-string-literal-for-symbols.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2014-01-24-using-string-literal-for-symbols.html">Read more</a>

<h4><a href="../posts/2014-01-20-type-checking-with-phantom-type.html">Type Checking with Phantom Type</a></h4> - January 20, 2014
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - Type Checking with Phantom Type</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Type Checking with Phantom Type</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on January 20, 2014
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/Haskell.html">Haskell</a>, <a href="../tags/phantom%20type.html">phantom type</a>, <a href="../tags/empty%20type.html">empty type</a>
      
  </div>

<p>In a toy programming language compiler I’ve written recently, the AST for <code>Program</code> has a type variable <code>a</code> which is not used on the right-hand side of its definition.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">data</span> <span class="dt">Program</span> a <span class="fu">=</span>
    <span class="dt">PDefs</span> [<span class="dt">Def</span>]
    <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</code></pre></div>
<p>Here <code>Program</code> is a <a href="http://www.haskell.org/haskellwiki/Phantom_type">phantom type</a> because the type parameter <code>a</code> does not appear after the <code>=</code> sign.</p>
<p>But why do we need a type variable if it won’t be used anyway? You can see the hint from the type signature of the type checker:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">check ::</span> (<span class="dt">Program</span> <span class="dt">NoTypeAnnotation</span>) <span class="ot">-&gt;</span> <span class="dt">Either</span> <span class="dt">TypeError</span> (<span class="dt">Program</span> <span class="dt">TypeAnnotation</span>)</code></pre></div>
<p>Once a program passes type checking, its type changes from <code>Program NoTypeAnnotation</code> to <code>Program TypeAnnotation</code>. A type variable <code>a</code> is used to differentiate a program with and without type annotations.</p>
<p>Later compiler phases explicitly require its argument type to be <code>Program TypeAnnotation</code>, so I can’t accidentally pass a program which hasn’t been type-checked yet. For example, <code>desugarProgram</code> requires its argument to be of type <code>Program TypeAnnotation</code>.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">desugarProgram ::</span> <span class="dt">Program</span> <span class="dt">TypeAnnotation</span> <span class="ot">-&gt;</span> <span class="dt">ProgramC</span></code></pre></div>
<p><code>NoTypeAnnotation</code> and <code>TypeAnnotation</code> are declared as <a href="https://wiki.haskell.org/Empty_type">empty type</a>s because their values are never needed. <a href="https://prime.haskell.org/wiki/EmptyDataDecls">EmptyDataDecls</a> language extension allows us to not specify any constructors as in the following:</p>
<pre><code>data NoTypeAnnotation
data TypeAnnotation</code></pre>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2014-01-20-type-checking-with-phantom-type.html";
    this.page.identifier = "/posts/2014-01-20-type-checking-with-phantom-type.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2014-01-20-type-checking-with-phantom-type.html">Read more</a>

<h4><a href="../posts/2014-01-16-applicative-parsing.html">Applicative parsing</a></h4> - January 16, 2014
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - Applicative parsing</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Applicative parsing</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on January 16, 2014
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/Haskell.html">Haskell</a>, <a href="../tags/applicative%20functor.html">applicative functor</a>, <a href="../tags/applicative%20parsing.html">applicative parsing</a>
      
  </div>

<p>While implementing a parser for a toy imperative language, I used a parser combinator library <a href="https://hackage.haskell.org/package/parsec">Parsec</a>, which supports both applicative parsing and monadic parsing. I first wrote the parser in monadic style and then changed it to applicative style because it gave me a more succinct parser.</p>
<p>This article explains the difference between these two styles and discusses the benefits of applicative parsing over monadic parsing.</p>
<p>Here a simple C like program fragment:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">int max(int a, b)
{
    <span class="kw">if</span> (a <span class="fu">&gt;</span> b)
        return a;
    <span class="kw">else</span>
        return b;
}</code></pre></div>
<p>The following is a snippet of the AST.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">data</span> <span class="dt">Def</span> <span class="fu">=</span> <span class="dt">DFun</span> <span class="dt">Type</span> <span class="dt">Id</span> [<span class="dt">Arg</span>] [<span class="dt">Stm</span>]

<span class="kw">data</span> <span class="dt">Stm</span> <span class="fu">=</span>
    <span class="fu">...</span>
    <span class="fu">|</span> <span class="dt">SIfElse</span> <span class="dt">Exp</span> <span class="dt">Stm</span> <span class="dt">Stm</span></code></pre></div>
<p>The parser for function definitions is compact. <code>DFun</code> is a pure function which takes 4 arguments. For each argument, we need to perform an effectful computation, which is parsing. So I used <code>($)</code> to lift a pure value to the effectful world and applied effectful arguments using <code>(*)</code>.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">def ::</span> <span class="dt">Parser</span> <span class="dt">Def</span>
def <span class="fu">=</span> <span class="dt">DFun</span> <span class="fu">&lt;$&gt;</span> typ <span class="fu">&lt;*&gt;</span> ident <span class="fu">&lt;*&gt;</span> parens (commaSep arg) <span class="fu">&lt;*&gt;</span> braces (many stm)</code></pre></div>
<p>The same parser can be written in monadic style as in the following. You can see that we need to create more bindings to name intermediate results.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">def ::</span> <span class="dt">Parser</span> <span class="dt">Def</span>
def <span class="fu">=</span> <span class="kw">do</span>
    t <span class="ot">&lt;-</span> typ
    id <span class="ot">&lt;-</span> ident
    args <span class="ot">&lt;-</span> parens (commaSep arg)
    stms <span class="ot">&lt;-</span> braces (many stm)
    return <span class="fu">$</span> <span class="dt">Dfun</span> t id args stms</code></pre></div>
<p>Let’s look at another example. <code>ifElseStm</code> is a parser which parses an if-else statement into a <code>STM</code> instance with <code>SIfElse</code> data constructor. Here <code>(*&gt;)</code> is used to sequencing actions, discarding the result of the first operand because we don’t need to store “if” and “else” keywords in the AST.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">ifElseStm ::</span> <span class="dt">Parser</span> <span class="dt">Stm</span>
ifElseStm <span class="fu">=</span>  <span class="dt">SIfElse</span> <span class="fu">&lt;$&gt;</span> (reserved <span class="st">&quot;if&quot;</span> <span class="fu">*&gt;</span> parens exp) <span class="fu">&lt;*&gt;</span> stm <span class="fu">&lt;*&gt;</span> (reserved <span class="st">&quot;else&quot;</span> <span class="fu">*&gt;</span> stm)</code></pre></div>
<p>The same parser also can be written in monadic style.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">ifElseStm ::</span> <span class="dt">Parser</span> <span class="dt">Stm</span>
ifElseStm <span class="fu">=</span>  <span class="kw">do</span>
    reserved <span class="st">&quot;if&quot;</span>
    condExp <span class="ot">&lt;-</span> exp
    thenStm <span class="ot">&lt;-</span> stm
    reserved <span class="st">&quot;else&quot;</span>
    elseStm <span class="ot">&lt;-</span> stm
    return <span class="fu">$</span> <span class="dt">SIfElse</span> condExp thenStm elseStm</code></pre></div>
<p>In monadic parsing, <code>(&gt;&gt;)</code> is used to discard the result of an effectful computation. This parser also creates a lot of bindings to name intermediate results.</p>
<p>From these two examples, we can see the stylistic difference between applicative parsing and monadic parsing. Applicative parsing is more succinct in this particular example. This is not always true, so I usually try both options to find the better one.</p>
<p>However, the difference is not just on the style. The real difference is in how sequential composition is handled. Monad is more powerful than applicative functor, but that’s the exact reason why we can reason about monad less than applicative functor. This difference in turn gives applicative parsing better performance optimization chances. <a href="http://stackoverflow.com/questions/7861903/what-are-the-benefits-of-applicative-parsing-over-monadic-parsing">What are the benefits of applicative parsing over monadic parsing?</a> explains this point well.</p>
<p>For more in-depth understanding of applicative programming, refer to <a href="http://strictlypositive.org/IdiomLite.pdf">FUNCTIONAL PEARL: Applicative programming with eﬀects</a>.</p>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2014-01-16-applicative-parsing.html";
    this.page.identifier = "/posts/2014-01-16-applicative-parsing.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2014-01-16-applicative-parsing.html">Read more</a>

<h4><a href="../posts/2014-01-15-the-power-of-lazy-evaluation.html">The power of lazy evaluation</a></h4> - January 15, 2014
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - The power of lazy evaluation</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>The power of lazy evaluation</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on January 15, 2014
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/Haskell.html">Haskell</a>, <a href="../tags/lazy%20evaluation.html">lazy evaluation</a>, <a href="../tags/backtracking.html">backtracking</a>, <a href="../tags/exception%20handling.html">exception handling</a>
      
  </div>

<p><a href="https://rkrishnan.org/files/wadler-1985.pdf">How to replace failure by a list of successes</a> is a classic paper which shows the power of lazy evaluation with respect to exception handling, backtracking and pattern matching. It says we don’t need special language constructs because these features can be emulated only with lazy evaluation.</p>
<p>The idea is simple. Each term that may raise an exception of backtrack is replaced by a term that returns a list of values; <code>[]</code> for failure and a singleton list for success.</p>
<ul>
<li>(failure) -&gt; []</li>
<li>(success) -&gt; [v]</li>
</ul>
<p>A term that might return many values through backtracking is replaced by a term that returns a list of those values.</p>
<ul>
<li>(backtracking) -&gt; [v1, v2, …]</li>
</ul>
<p>There are two ways of combining terms that may raise exceptions or backtrack.</p>
<blockquote>
<p>“or” combination is a way of combining two terms so that evaluation of the resulting term succeeds whenever evaluation of the first term <em>or</em> the second term succeeds.</p>
</blockquote>
<p>“or” combination can be implemented with list append, <code>(++)</code>.</p>
<blockquote>
<p>“and” combination is a way of combining two terms so that evaluation of the resulting term succeeds whenever evaluation of the first term <em>and</em> the second term succeeds.</p>
</blockquote>
<p>“and” combination can be implemented with cartesian product.</p>
<p>Let’s look at an example. <code>assoc</code> is a function that looks up entries in an association list. Given a list of pairs <code>xys</code> and a value <code>x</code>, the call <code>assoc xys x</code> returns <code>y</code> such that the pair <code>(x, y)</code> is in the list <code>xys</code>. If there is no such <code>y</code>, the call should raise an exception. <code>assoc</code> can be written in Haskell using list comprehension:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">assoc xys x <span class="fu">=</span> [y <span class="fu">|</span> (x', y) <span class="ot">&lt;-</span> xys, x' <span class="fu">==</span> x]</code></pre></div>
<p>Here are the results of some experiments on assoc.</p>
<ul>
<li>assoc [(“a”, 1), (“a”, 3)] “a” = [1,3]</li>
<li>assoc [(“a”, 1), (“b”, 2)] “b” = [2]</li>
<li>assoc [(“a”, 1), (“b”, 2)] “c” = [0]</li>
</ul>
<p>“Or” combinator <code>(assoc xys1 x) ? (assoic xys2 x)</code> can be written</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">assoc xys1 x <span class="fu">++</span> assoc xys2 x</code></pre></div>
<p>and “and” combinator <code>(assoc xys x) + (assoic xys2 x)</code> can be written</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">[y1 <span class="fu">+</span> y2 <span class="fu">|</span> [y1 <span class="ot">&lt;-</span> assoic xys1 x, y2 <span class="ot">&lt;-</span> assoc xys2 x]</code></pre></div>
<p>Backtracking usually requires special language features such as coroutines or generators because evaluation of an expression needs to be <em>suspended</em> after it has returned one value, and then may be <em>resumed</em> later if more values are needed. Lazy evaluation provides this property without any additional language features. That is, evaluation of a list is already performed only when more elements are needed.</p>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2014-01-15-the-power-of-lazy-evaluation.html";
    this.page.identifier = "/posts/2014-01-15-the-power-of-lazy-evaluation.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2014-01-15-the-power-of-lazy-evaluation.html">Read more</a>

<h4><a href="../posts/2014-01-15-overloaded-string-literals.html">Overloaded string literals</a></h4> - January 15, 2014
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - Overloaded string literals</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Overloaded string literals</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on January 15, 2014
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/Haskell.html">Haskell</a>, <a href="../tags/OverloadedStrings.html">OverloadedStrings</a>, <a href="../tags/IsString.html">IsString</a>, <a href="../tags/language%20extension.html">language extension</a>
      
  </div>

<p>In Haskell, the type of a string literal <code>&quot;Hello World&quot;</code> is always <code>String</code> which is defined as <code>[Char]</code> though there are other textual data types such as <code>ByteString</code> and <code>Text</code>. To put it another way, string literals are monomorphic.</p>
<p>GHC provides a language extension called <a href="https://downloads.haskell.org/~ghc/7.0.4/docs/html/users_guide/type-class-extensions.html">OverloadedStrings</a>. When enabled, literal strings have the type <code>IsString a =&gt; a</code>. <code>IsString</code> moudle is defined in <code>Data.String</code> module of base package:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">class</span> <span class="dt">IsString</span> a <span class="kw">where</span>
<span class="ot">    fromString ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> a</code></pre></div>
<p><code>ByteString</code> and <code>Text</code> are examples of <code>IsString</code> instances, so you can declare the type of string literals as <code>ByteString</code> or <code>Text</code> when <code>OverloadedStrings</code> is enabled.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">{-# LANGUAGE OverloadedStrings #-}</span>
<span class="ot">a ::</span> <span class="dt">Text</span>
a <span class="fu">=</span> <span class="st">&quot;Hello World&quot;</span>

<span class="ot">b ::</span> <span class="dt">ByteString</span>
b <span class="fu">=</span> <span class="st">&quot;Hello World&quot;</span></code></pre></div>
<p>Of course, <code>String</code> is also an instance of <code>IsString</code>. So you can declare the type of a string literal as <code>String</code> as usual.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">c ::</span> <span class="dt">String</span>
c <span class="fu">=</span> <span class="st">&quot;Hello World&quot;</span></code></pre></div>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2014-01-15-overloaded-string-literals.html";
    this.page.identifier = "/posts/2014-01-15-overloaded-string-literals.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2014-01-15-overloaded-string-literals.html">Read more</a>

<h4><a href="../posts/2014-01-14-difference-listfor-writer-monad.html">Difference List for Writer Monad</a></h4> - January 14, 2014
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - Difference List for Writer Monad</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Difference List for Writer Monad</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on January 14, 2014
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/Haskell.html">Haskell</a>, <a href="../tags/difference%20list.html">difference list</a>, <a href="../tags/writer%20monad.html">writer monad</a>
      
  </div>

<p>In writing a compiler in Haskell, it is conventional to use the <a href="https://hackage.haskell.org/package/mtl-2.0.1.0/docs/Control-Monad-Writer-Lazy.html">Writer monad</a> to accumulate emitted code.</p>
<p>The class declaration of <code>MonadWriter</code> is</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">class</span> (<span class="dt">Monoid</span> w, <span class="dt">Monad</span> m) <span class="ot">=&gt;</span> <span class="dt">MonadWriter</span> w m <span class="fu">|</span> m <span class="ot">-&gt;</span> w <span class="kw">where</span></code></pre></div>
<p>Here <code>w</code> must be a <a href="http://hackage.haskell.org/package/base-4.6.0.1/docs/Data-Monoid.html">Monoid</a> instance, so that <code>MonadWriter</code> can combine the outputs of the subcomputations using <a href="http://hackage.haskell.org/package/base-4.6.0.1/docs/Data-Monoid.html#v:mappend">mappend</a>.</p>
<p>A naive implementation of a compiler can use <code>MonadWriter [String]</code> to accumulate emitted code. Haskell list is an instance of <code>Monoid</code> and its <code>mappend</code> function is implemented with <code>(++)</code> which appends two lists.</p>
<p>This looks okay at first, but it is not an efficient way to use the <code>Writer</code> monad because the time complexity of <code>(++)</code> is O(n) on the length of the first operand. Because the first operand gets bigger as <code>MonadWriter</code> accumulates more code, the time complexity of <code>MonadWriter [a]</code> becomes quadratic.</p>
<p>A <a href="https://en.wikipedia.org/wiki/Difference_list">Difference list</a> is the rescue because it is a <code>Monoid</code> instance which supports O(1) <code>append</code> and <code>snoc</code> operations on lists. So we can use <code>MonadWriter (DList Instruction)</code> instead of <code>MonadWriter [Instruction]</code> to accumulate emitted code and convert it to a list using <code>DList.toList</code>.</p>
<p>Wikipedia explains the term difference list as in the following:</p>
<blockquote>
<p>In the second approach, difference lists are implemented as single-argument functions, which take a list as argument and prepend to that list. As a consequence, concatenation of difference lists of the second type is implemented essentially as function composition, which is O(1). However, of course the list still has to be constructed eventually (assuming all of its elements are needed), which is plainly at least O(n).</p>
</blockquote>
<p>There is a chapter on Real World Haskell about the difference list: <a href="http://book.realworldhaskell.org/read/data-structures.html">Chapter 13. Data Structures</a>. Learn you Haskell for a Great Good also provides a chapter on the difference list: <a href="http://learnyouahaskell.com/for-a-few-monads-more">For a Few Monads More</a>.</p>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2014-01-14-difference-listfor-writer-monad.html";
    this.page.identifier = "/posts/2014-01-14-difference-listfor-writer-monad.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2014-01-14-difference-listfor-writer-monad.html">Read more</a>

<h4><a href="../posts/2014-01-13-DoAndIfThenElse-language-extension.html">DoAndIfThenElse language extension</a></h4> - January 13, 2014
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - DoAndIfThenElse language extension</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>DoAndIfThenElse language extension</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on January 13, 2014
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/Haskell.html">Haskell</a>, <a href="../tags/DoAndIfThenElse.html">DoAndIfThenElse</a>, <a href="../tags/language%20extension.html">language extension</a>
      
  </div>

<p>Have you ever encountered “Unexpected semi-colons in conditional” errors while building your project with Cabal and wondered why? This blog post explains about this puzzling error.</p>
<p>Here is a simple program which prints the given command line arguments.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">import </span><span class="dt">System.Environment</span>
 
main <span class="fu">=</span> <span class="kw">do</span>
    args <span class="ot">&lt;-</span> getArgs
    <span class="kw">if</span> length args <span class="fu">&lt;</span> <span class="dv">1</span> <span class="kw">then</span>
        putStrLn <span class="st">&quot;Usage: DoAndIfThenElse [args]&quot;</span>
    <span class="kw">else</span>
        putStrLn <span class="fu">$</span> concat args</code></pre></div>
<p>You can build this Haskell program with <code>ghc –make</code>:</p>
<pre><code>ghc --make DoAndIfThenElse.hs
[1 of 1] Compiling Main             ( DoAndIfThenElse.hs, DoAndIfThenElse.o )
Linking DoAndIfThenElse ...</code></pre>
<p>Okay. Then let’s create a Cabal build script and build this program with Cabal.</p>
<pre><code>name:            DoAndIfThenElse
version:         0.0.1
cabal-version:   &gt;= 1.8
build-type:      Simple
 
executable DoAndIfThenElse
  hs-source-dirs:    src
  main-is:           DoAndIfThenElse.hs
  build-depends:     base</code></pre>
<p>The source code is exactly the same, but now GHC suddenly complains about the unexpected semi-colons we never inserted anyway.</p>
<pre><code>src/DoAndIfThenElse.hs:5:8:
    Unexpected semi-colons in conditional:
        if length args &lt; 1 then putStrLn
                                  &quot;Usage: DoAndIfThenElse [args]&quot;; else putStrLn $ concat args
    Perhaps you meant to use -XDoAndIfThenElse?</code></pre>
<p>You can fix this problem by adding <code>DoAndIfThenElse</code> language pragma at the beginning:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">{-# LANGUAGE DoAndIfThenElse #-}</span></code></pre></div>
<p>Or you can fix it by changing the indentation of <em>then</em> and <em>else</em> of <em>if</em> expression.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">if</span> length args <span class="fu">&lt;</span> <span class="dv">1</span>
    <span class="kw">then</span> putStrLn <span class="st">&quot;Usage: DoAndIfThenElse [args]&quot;</span>
    <span class="kw">else</span> putStrLn <span class="fu">$</span> concat args</code></pre></div>
<p>So the problem is on the indentation. You have to keep <em>then</em> and <em>else</em> at deeper indentation levels than the <em>if</em> block they belong.</p>
<p><code>ghc –make</code> is okay because GHC automatically turns on the syntax extension <code>DoAndIfThenElse</code>. However, Cabal is more picky, so you have to turn it on manually either at the top of your code files, or in your Cabal files.</p>
<p>There is also a StackOverflow question on this issue, <a href="http://stackoverflow.com/questions/10076318/unexpected-semi-colons-in-conditional">Unexpected semi-colons in conditional</a>.</p>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2014-01-13-DoAndIfThenElse-language-extension.html";
    this.page.identifier = "/posts/2014-01-13-DoAndIfThenElse-language-extension.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2014-01-13-DoAndIfThenElse-language-extension.html">Read more</a>

<h4><a href="../posts/2014-01-07-parsing-arithmetic-expressions-with-parsec.html">Parsing arithmetic expressions with Parsec</a></h4> - January  7, 2014
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - Parsing arithmetic expressions with Parsec</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Parsing arithmetic expressions with Parsec</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on January  7, 2014
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/Haskell.html">Haskell</a>, <a href="../tags/Parsec.html">Parsec</a>
      
  </div>

<p><a href="http://hackage.haskell.org/package/parsec">Parsec</a> provides <a href="http://hackage.haskell.org/package/parsec-3.1.4/docs/Text-Parsec-Expr.html">Text.Parsec.Expr</a> module to parse <em>expressions</em>. <code>buildExpressionParser</code> creates an expression parser from the given operator table.</p>
<p>For example, let’s assume that we want to parse a simple arithmetic expression such as <code>1+2*3-4/2</code>. Here <code>*</code> and <code>/</code> has higher precedence than <code>+</code>, <code>-</code> and all operators are left-associative. We can represent the grammar in <a href="http://bnfc.digitalgrammars.com/">BNF Converter</a> notation.</p>
<pre><code>EAdd. Exp ::= Exp &quot;+&quot; Exp1 ;
ESub. Exp ::= Exp &quot;-&quot; Exp1 ;
EMul. Exp1 ::= Exp1 &quot;*&quot; Exp2 ;
EDiv. Exp1 ::= Exp1 &quot;/&quot; Exp2 ;
EInt. Exp2 ::= Integer ;

coercions Exp 2 ;</code></pre>
<p>Here’s our AST for the arithmetic expression.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">data</span> <span class="dt">Exp</span> <span class="fu">=</span> <span class="dt">EAdd</span> <span class="dt">Exp</span> <span class="dt">Exp</span>
         <span class="fu">|</span> <span class="dt">ESub</span> <span class="dt">Exp</span> <span class="dt">Exp</span>
         <span class="fu">|</span> <span class="dt">EMul</span> <span class="dt">Exp</span> <span class="dt">Exp</span>
         <span class="fu">|</span> <span class="dt">EDiv</span> <span class="dt">Exp</span> <span class="dt">Exp</span>
         <span class="fu">|</span> <span class="dt">EInt</span> <span class="dt">Integer</span></code></pre></div>
<p>We can build an expression parser, <code>expr</code> as in the following. We specify operators with their precedences and associativities in the operator table. Operators with higher precedence come first in the operator table. So <code>*</code> and <code>/</code> has higher precedence than <code>+</code> and <code>-</code> in this example.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">term <span class="fu">=</span>  parens expr
    <span class="fu">&lt;|&gt;</span> <span class="dt">EInt</span> <span class="fu">&lt;$&gt;</span> natural

table <span class="fu">=</span> [ [binary <span class="st">&quot;*&quot;</span> <span class="dt">EMul</span> <span class="dt">AssocLeft</span>, binary <span class="st">&quot;/&quot;</span> <span class="dt">EDiv</span> <span class="dt">AssocLeft</span> ]
        , [binary <span class="st">&quot;+&quot;</span> <span class="dt">EAdd</span> <span class="dt">AssocLeft</span>, binary <span class="st">&quot;-&quot;</span> <span class="dt">ESub</span> <span class="dt">AssocLeft</span> ]
        ]

binary  name fun assoc <span class="fu">=</span> <span class="dt">Infix</span>   (<span class="kw">do</span> { reservedOp name; return fun }) assoc

<span class="ot">expr ::</span> <span class="dt">Parser</span> <span class="dt">Exp</span>
expr <span class="fu">=</span> buildExpressionParser table term</code></pre></div>
<p><code>Text.Parsec.Expr</code> can handle prefix and postfix operators too. We can use the following helper functions to specify these operators.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">prefix  name fun       <span class="fu">=</span> <span class="dt">Prefix</span> (<span class="kw">do</span> { reservedOp name; return fun })
postfix name fun       <span class="fu">=</span> <span class="dt">Postfix</span> (<span class="kw">do</span> { reservedOp name; return fun })</code></pre></div>
<p>See <a href="https://github.com/kseo/calc">the calculator example</a> for the complete code.</p>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2014-01-07-parsing-arithmetic-expressions-with-parsec.html";
    this.page.identifier = "/posts/2014-01-07-parsing-arithmetic-expressions-with-parsec.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2014-01-07-parsing-arithmetic-expressions-with-parsec.html">Read more</a>

<h4><a href="../posts/2013-12-26-defects-of-von-neumann-languages.html">Defects of von Neumann languages</a></h4> - December 26, 2013
<article>

    <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="Haskell, functional programming, category theory, type theory">
        <title>Kwang's Haskell Blog - Defects of von Neumann languages</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Kwang's Haskell Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Defects of von Neumann languages</h1>
<a class="twitter-share-button" href="https://twitter.com/intent/tweet?via=kwangyulseo">Tweet</a>

<article>
  <div class="info">
      Posted on December 26, 2013
      
          by Kwang Yul Seo
      
  </div>
  <div class="info">
      
      Tags: <a href="../tags/Haskell.html">Haskell</a>, <a href="../tags/von%20Neumann.html">von Neumann</a>, <a href="../tags/John%20Backus.html">John Backus</a>, <a href="../tags/FP.html">FP</a>
      
  </div>

<p><a href="https://en.wikipedia.org/wiki/John_Backus">John Backus</a>, the inventor of Fortran criticized the defects of von Neumann languages (aka, imperative languages) in his <a href="http://worrydream.com/refs/Backus-CanProgrammingBeLiberated.pdf">1977 Turing Award Lecture</a>. Most of his points still remain valid until today!</p>
<p>The defects can be summarized:</p>
<ul>
<li>close coupling of semantics to state transitions</li>
<li>division of programming into a world of expressions and a world of statements</li>
<li>inability to effectively use powerful combining forms for building new programs from existing ones</li>
<li>lack of mathematical properties for reasoning about programs</li>
</ul>
<p>He described conventional programming languages as <em>fat and flabby</em> because each successive programming language adds more and more features with little cleaning up. Even though most conventional languages are similar as they simply add higher level constructs to the same underlying von Neumann computing model, learning a new language still takes long time due to many subtle corner cases in their semantics.</p>
<p>He evaluated von Neumann model with 4 criteria:</p>
<ul>
<li><em>Foundations</em>: complex, bulky, not useful compared to Turing machines, various automata, Church’s lambda calculus or Curry’s system of combinators</li>
<li><em>History sensitivity</em>: have storage, are history sensitive</li>
<li><em>Type of semantics</em>: state transition with complex states (not simple as in automata)</li>
<li><em>Clarity and conceptual usefulness of programs</em>: programs can be moderately clear, are not very useful conceptually</li>
</ul>
<p>What’s the von Neumann computer? It has three parts: CPU, a store and a connecting tube that can transmit a single word between the CPU and the store. Programming on this machine is to change the contents of the store by repeatedly transferring single words between CPU and the store through the tube. So he called this tube the von Neumann bottleneck.</p>
<p>By the von Neumann bottleneck, he does not mean the limited bandwidth of the tunnel (bus). The real problem is that it becomes an intellectual bottleneck that keeps us tied to word-at-a-time thinking instead of larger conceptual thinking. The assignment statement in von Neumann languages corresponds to the von Neumann bottleneck which keeps us thinking in word-at-a-time terms in much the same way the computer’s bottleneck does.</p>
<p>So he proposed Functional Programming (FP) system as an alternative to von Neumann languages. FP is a functional programming language in point-free style. Please read the original paper for the details of the language. If you are interested in the implementation of FP, <a href="https://github.com/kseo/fp">FP</a> is my Haksell implementation of FP.</p>
<div id="disqus_thread"></div>
<script>

/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */
var disqus_config = function () {
    this.page.url = "https://kseo.github.io/posts/2013-12-26-defects-of-von-neumann-languages.html";
    this.page.identifier = "/posts/2013-12-26-defects-of-von-neumann-languages.html";
};
(function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//kwangs-haskell-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>

        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>


</article>
<a href="../posts/2013-12-26-defects-of-von-neumann-languages.html">Read more</a>



        </div>
        <div id="footer">
            <a href="../rss.xml">RSS</a> |
            <a href="../atom.xml">ATOM</a> |
            <a href="https://twitter.com/kwangyulseo" class="twitter-follow-button" data-show-count="false">Follow @kwangyulseo</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-61779656-7', 'auto');
          ga('send', 'pageview');
        </script>
    </body>
</html>
